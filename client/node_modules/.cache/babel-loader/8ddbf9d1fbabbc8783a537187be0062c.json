{"ast":null,"code":"import _defineProperty from \"/media/afwani/3D2F2E7121F9CF4F/crwn-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { call, all, put, takeLatest } from 'redux-saga/effects';\nimport { auth, createUserProfileDocument, googleProvider } from '../../firebase.util.js';\nimport { signSuccess, signFailure, signOutSuccess, signOutFailure, signUpSuccess, signUpFailure } from './user.action.jsx';\nimport userActionType from './user.types.jsx';\nimport { getCurrentUser } from '../../firebase.util.js';\nexport function* getSnapshotFromUserAuth(user, data) {\n  try {\n    const userRef = yield call(createUserProfileDocument, user);\n    const userSnapShot = yield userRef.get();\n    yield put(signSuccess(_objectSpread({\n      id: userSnapShot.id\n    }, userSnapShot.data())));\n  } catch (err) {\n    yield put(signFailure(err));\n  }\n}\nexport function* isAuthUser() {\n  try {\n    const userAuth = yield getCurrentUser();\n    if (!userAuth) return;\n    yield getSnapshotFromUserAuth(userAuth);\n  } catch (err) {\n    yield signFailure(err);\n  }\n}\nexport function* signInWithGoogle() {\n  try {\n    const _ref = yield auth.signInWithPopup(googleProvider),\n          user = _ref.user;\n\n    yield getSnapshotFromUserAuth(user);\n  } catch (err) {\n    yield put(signFailure(err));\n  }\n}\nexport function* signInWithEmail({\n  payload: {\n    email,\n    password\n  }\n}) {\n  try {\n    const _ref2 = yield auth.signInWithEmailAndPassword(email, password),\n          user = _ref2.user;\n\n    yield put(signUpSuccess({\n      user\n    }));\n  } catch (err) {\n    yield put(signOutFailure(err));\n  }\n}\nexport function* signInAfterSignUp({\n  payload: {\n    user,\n    data\n  }\n}) {\n  yield getSnapshotFromUserAuth(user, data);\n  yield isAuthUser();\n}\nexport function* signOut() {\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  } catch (error) {\n    yield put(signOutFailure(error));\n  }\n}\nexport function* signUp({\n  payload: {\n    displayName,\n    email,\n    password\n  }\n}) {\n  try {\n    const _ref3 = yield auth.createUserWithEmailAndPassword(email, password),\n          user = _ref3.user;\n\n    yield put(signUpSuccess({\n      user,\n      data: {\n        displayName\n      }\n    }));\n  } catch (err) {\n    yield put(signUpFailure(err));\n  }\n}\nexport function* onSignUpSuccess() {\n  yield takeLatest(userActionType.SIGN_UP_SUCCESS, signInAfterSignUp);\n}\nexport function* onGoogleSignInStart() {\n  yield takeLatest(userActionType.GOOGLE_SIGN_IN_START, signInWithGoogle);\n}\nexport function* onEmailSignInStart() {\n  yield takeLatest(userActionType.EMAIL_SIGN_IN_START, signInWithEmail);\n}\nexport function* onSignOutStart() {\n  yield takeLatest(userActionType.SIGN_OUT_START, signOut);\n}\nexport function* onCheckSessionStart() {\n  yield takeLatest(userActionType.USER_SESSION_CHECK, isAuthUser);\n}\nexport function* onSignUpStart() {\n  yield takeLatest(userActionType.SIGN_UP_START, signUp);\n}\nexport function* userSaga() {\n  yield all([call(onGoogleSignInStart), call(onEmailSignInStart), call(onCheckSessionStart), call(onSignOutStart), call(onSignUpStart), call(onSignUpSuccess)]);\n}","map":{"version":3,"sources":["/media/afwani/3D2F2E7121F9CF4F/crwn-clothing/client/src/redux/user/user.sagas.jsx"],"names":["call","all","put","takeLatest","auth","createUserProfileDocument","googleProvider","signSuccess","signFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","userActionType","getCurrentUser","getSnapshotFromUserAuth","user","data","userRef","userSnapShot","get","id","err","isAuthUser","userAuth","signInWithGoogle","signInWithPopup","signInWithEmail","payload","email","password","signInWithEmailAndPassword","signInAfterSignUp","signOut","error","signUp","displayName","createUserWithEmailAndPassword","onSignUpSuccess","SIGN_UP_SUCCESS","onGoogleSignInStart","GOOGLE_SIGN_IN_START","onEmailSignInStart","EMAIL_SIGN_IN_START","onSignOutStart","SIGN_OUT_START","onCheckSessionStart","USER_SESSION_CHECK","onSignUpStart","SIGN_UP_START","userSaga"],"mappings":"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","sourcesContent":["import { call,all,put,takeLatest } from 'redux-saga/effects';\n\nimport { \n\tauth,\n\tcreateUserProfileDocument,\n\tgoogleProvider\n} from '../../firebase.util.js';\n\nimport {\n\tsignSuccess,\n\tsignFailure,\n\tsignOutSuccess,\n\tsignOutFailure,\n\tsignUpSuccess,\n\tsignUpFailure,\n} from './user.action.jsx';\n\nimport userActionType from './user.types.jsx';\nimport { getCurrentUser } from '../../firebase.util.js';\n\n\nexport function* getSnapshotFromUserAuth(user,data){\n\ttry{\n\t\tconst userRef = yield call(createUserProfileDocument,user);\n\t\tconst userSnapShot = yield userRef.get();\n\t\tyield put(\n\t\t\tsignSuccess({id:userSnapShot.id,...userSnapShot.data()})\n\t\t);\n\t}catch(err){\n\t\tyield put(\n\t\t\tsignFailure(err)\n\t\t);\n\t}\n}\n\nexport function* isAuthUser(){\n\ttry{\n\t\tconst userAuth = yield getCurrentUser();\n\t\tif(!userAuth) return;\n\t\tyield getSnapshotFromUserAuth(userAuth);\n\t}catch(err){\n\t\tyield signFailure(err);\n\t}\n}\n\nexport function* signInWithGoogle(){\n\ttry{\n\t\tconst { user } = yield auth.signInWithPopup(googleProvider);\n\t\tyield getSnapshotFromUserAuth(user);\n\t}catch(err){\n\t\tyield put(\n\t\t\tsignFailure(err)\n\t\t);\n\t}\n}\n\nexport function* signInWithEmail({payload:{email,password}}){\n\ttry{\n\t\tconst { user } = yield auth.signInWithEmailAndPassword(email,password);\n\t\tyield put(signUpSuccess({user}))\n\t}catch(err){\n\t\tyield put(signOutFailure(err));\n\t}\n}\n\nexport function* signInAfterSignUp({payload:{user,data}}){\n\tyield getSnapshotFromUserAuth(user,data);\n\tyield isAuthUser();\n}\n\nexport function* signOut() {\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  } catch (error) {\n    yield put(signOutFailure(error));\n  }\n}\n\n\nexport function* signUp({payload:{displayName, email, password}}){\n\ttry{\n\t\tconst { user } = yield auth.createUserWithEmailAndPassword(\n        email,\n        password);\n\t\tyield put(signUpSuccess({user,data:{displayName}}))\n\t}catch(err){\n\t\tyield put(signUpFailure(err))\n\t}\n}\n\nexport function* onSignUpSuccess(){\n\tyield takeLatest(userActionType.SIGN_UP_SUCCESS,signInAfterSignUp)\n}\n\nexport function* onGoogleSignInStart(){\n\tyield takeLatest(userActionType.GOOGLE_SIGN_IN_START,signInWithGoogle);\n}\n\nexport function* onEmailSignInStart(){\n\tyield takeLatest(userActionType.EMAIL_SIGN_IN_START,signInWithEmail);\n}\n\nexport function* onSignOutStart(){\n\tyield takeLatest(userActionType.SIGN_OUT_START, signOut);\n}\n\nexport function* onCheckSessionStart(){\n\tyield takeLatest(userActionType.USER_SESSION_CHECK,isAuthUser);\n}\n\nexport function* onSignUpStart(){\n\tyield takeLatest(userActionType.SIGN_UP_START,signUp)\n}\n\nexport function* userSaga(){\n\tyield all([\n\t\tcall(onGoogleSignInStart),\n\t\tcall(onEmailSignInStart),\n\t\tcall(onCheckSessionStart),\n\t\tcall(onSignOutStart),\n\t\tcall(onSignUpStart),\n\t\tcall(onSignUpSuccess)\n\t])\n}"]},"metadata":{},"sourceType":"module"}